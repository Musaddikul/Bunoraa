{% load i18n %}
<div class="currency-selector {{ css_class }}">
    <div class="dropdown">
        <button type="button" class="flex items-center gap-1 text-sm text-secondary-600 hover:text-secondary-900">
            <span class="currency-current">{{ current_currency.code|default:"USD" }}</span>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
        </button>
        <div class="dropdown-menu">
            {% for currency in currencies %}
            <button 
                type="button" 
                class="dropdown-item w-full text-left flex items-center justify-between {% if currency.code == current_currency.code %}bg-primary-50 text-primary-600{% endif %}"
                data-currency="{{ currency.code }}"
            >
                <span>{{ currency.code }}</span>
                <span class="text-secondary-400">{{ currency.symbol }}</span>
            </button>
            {% empty %}
            <span class="dropdown-item text-secondary-400">{% trans "No currencies available" %}</span>
            {% endfor %}
        </div>
    </div>
</div>

<script type="module">
// Handle currency selection
document.querySelectorAll('[data-currency]').forEach(btn => {
    btn.addEventListener('click', () => {
        const code = btn.dataset.currency;
        
        // Set cookie
        document.cookie = `currency=${code};path=/;max-age=${60*60*24*365}`;
        
        // Update display
        document.querySelectorAll('.currency-current').forEach(el => {
            el.textContent = code;
        });
        
        // Reload to apply
        window.location.reload();
    });
});
</script>
