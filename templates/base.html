<!-- templates/base.html -->
<!DOCTYPE html>
{% load static %}
<html lang="en" data-theme="{{ theme }}">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="csrf-token" content="{{ csrf_token }}">

  <title>{% block title %}{{ site_name }} - Authentic Bangladeshi Products{% endblock %}</title>

  <!-- Favicon -->
  <link href="{% static 'images/favicon.ico' %}" rel="icon" type="image/x-icon" />

  <!-- Styles -->
  <link href="{% static 'css/tailwind.css' %}" rel="stylesheet" />
  <link href="{% static 'css/utils.css' %}" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" rel="stylesheet" />

  {% block extra_css %}{% endblock %}
</head>

<body class="font-mono bg-white text-[#333] dark:bg-[#181A1B] dark:text-[#DDD] transition-colors duration-300">

  {% include 'partials/navbar.html' %}
  <main class="min-h-screen py-6">{% block content %}{% endblock %}</main>
  {% include 'partials/footer.html' %}

  <!-- Back to Top Button -->
  <button id="backToTop"
    class="fixed bottom-5 right-5 bg-pink-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700">
    <i class="fas fa-arrow-up"></i>
  </button>

  <!-- Quick Cart Sidebar + Overlay -->
  <div id="quick-cart-sidebar" class="fixed top-0 right-0 h-full w-80 bg-white dark:bg-gray-800 shadow-lg z-50 transform translate-x-full transition-transform duration-300 ease-in-out">
    <div class="flex justify-between items-center p-4 border-b dark:border-gray-700">
      <h2 class="text-xl font-semibold">Your Cart</h2>
      <button onclick="closeCartSidebar()" class="text-gray-500 hover:text-gray-800 dark:hover:text-white">
        <i class="fas fa-times text-xl"></i>
      </button>
    </div>
    <div class="p-4 overflow-y-auto h-[calc(100%-60px)]" id="quick-cart-content">
      <div id="cart-sidebar-content-wrapper">
        <!-- Cart content will be loaded here by cart.js -->
        <div class="text-center text-gray-500 py-10">
          <i class="fas fa-spinner fa-spin text-2xl"></i>
          <p>Loading cart...</p>
        </div>
      </div>
    </div>
  </div>
  <div id="sidebar-backdrop" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>

  <!-- Product Quick View Modal -->
  <div id="product-quick-view-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[60] hidden">
    <div id="product-quick-view-backdrop" class="absolute inset-0"></div>
    <div class="relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full m-4 max-h-[90vh] overflow-y-auto">
      <button class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-white text-2xl close-modal-btn">
        <i class="fas fa-times"></i>
      </button>
      <div id="product-quick-view-content" class="min-h-[200px] flex items-center justify-center">
        <div classd="text-center text-gray-500 py-10">Loading product details...</div>
      </div>
    </div>
  </div>


  <!-- Notification Toast -->
  <div class="fixed bottom-4 right-4 z-50">
      <div id="notification"
            class="hidden bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg"
            x-data="{ show: false, message: '' }"
            x-show="show"
            x-transition:enter="transition ease-out duration-300"
            x-transition:enter-start="opacity-0 translate-y-2"
            x-transition:enter-end="opacity-100 translate-y-0"
            x-transition:leave="transition ease-in duration-200"
            x-transition:leave-start="opacity-100 translate-y-0"
            x-transition:leave-end="opacity-0 translate-y-2"
            @notification.window="
              message = $event.detail.message;
              show = true;
              setTimeout(() => show = false, 3000)">
          <span x-text="message"></span>
      </div>
  </div>


  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.1/dist/cdn.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/imask@6.4.3/dist/imask.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

  <!-- Modular JS -->
  <script src="{% static 'js/utils.js' %}"></script>
  <script src="{% static 'js/theme.js' %}"></script>
  <script src="{% static 'js/mobileMenu.js' %}"></script>
  <script src="{% static 'js/userDropdown.js' %}"></script>
  <script src="{% static 'js/swiperInit.js' %}"></script>
  <script src="{% static 'js/backToTop.js' %}"></script>
  <script src="{% static 'js/cart_js_interactions.js' %}"></script>
  <script src="{% static 'js/cart.js' %}"></script>
  <script src="{% static 'js/products.js' %}"></script>
  <script src="{% static 'js/wishlist.js' %}"></script>
  <script src="{% static 'js/app.js' %}"></script>


  <script>
    window.CSRF_TOKEN = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
  </script>

  {% block extra_js %}{% endblock %}
</body>

</html>
