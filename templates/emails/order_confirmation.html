{% extends "emails/base.html" %}

{% block title %}Order Confirmation - #{{ order.number }}{% endblock %}

{% block content %}
<h2>Thank you for your order! ðŸŽ‰</h2>
<p>Hi {{ order.customer_name }},</p>
<p>We've received your order and it's now being processed. You'll receive another email when your order ships.</p>

<div class="highlight-box">
    <strong>Order Number:</strong> #{{ order.number }}<br>
    <strong>Order Date:</strong> {{ order.created_at|date:"F j, Y" }}
</div>

<a href="{{ order_url }}" class="button">View Order Details</a>

<div class="divider"></div>

<h3>Order Summary</h3>
<div class="order-summary">
    {% for item in order.items.all %}
    <div class="order-item">
        {% if item.product.image %}
        <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}" class="order-item-image">
        {% endif %}
        <div class="order-item-details">
            <p class="order-item-name">{{ item.product.name }}</p>
            <p class="order-item-meta">Qty: {{ item.quantity }}</p>
        </div>
        <div class="order-item-price">${{ item.total }}</div>
    </div>
    {% endfor %}
    
    <div class="order-totals">
        <div class="order-totals-row">
            <span>Subtotal</span>
            <span>${{ order.subtotal }}</span>
        </div>
        <div class="order-totals-row">
            <span>Shipping</span>
            <span>{% if order.shipping_cost > 0 %}${{ order.shipping_cost }}{% else %}Free{% endif %}</span>
        </div>
        {% if order.discount_amount > 0 %}
        <div class="order-totals-row">
            <span>Discount</span>
            <span>-${{ order.discount_amount }}</span>
        </div>
        {% endif %}
        <div class="order-totals-row">
            <span>Tax</span>
            <span>${{ order.tax_amount }}</span>
        </div>
        <div class="order-totals-row total">
            <span>Total</span>
            <span>${{ order.total }}</span>
        </div>
    </div>
</div>

<div style="display: flex; gap: 20px;">
    <div class="address-box" style="flex: 1;">
        <div class="address-label">Shipping Address</div>
        <div class="address-text">
            {{ order.shipping_address.name }}<br>
            {{ order.shipping_address.address_line_1 }}<br>
            {% if order.shipping_address.address_line_2 %}{{ order.shipping_address.address_line_2 }}<br>{% endif %}
            {{ order.shipping_address.city }}, {{ order.shipping_address.state }} {{ order.shipping_address.postal_code }}<br>
            {{ order.shipping_address.country }}
        </div>
    </div>
    <div class="address-box" style="flex: 1;">
        <div class="address-label">Payment Method</div>
        <div class="address-text">
            {{ order.payment_method|default:"Credit Card" }}<br>
            {% if order.card_last_four %}**** **** **** {{ order.card_last_four }}{% endif %}
        </div>
    </div>
</div>

<div class="divider"></div>

<p><strong>Estimated Delivery:</strong> {{ order.estimated_delivery|default:"5-7 business days" }}</p>

<p>If you have any questions about your order, please don't hesitate to <a href="{{ contact_url }}">contact us</a>.</p>

<p>Thank you for shopping with Bunoraa!</p>
{% endblock %}
