(()=>{var W=(f,i)=>()=>(i||f((i={exports:{}}).exports,i),i.exports);var C=W(()=>{var p=(function(){"use strict";let f={home:HomePage,category:CategoryPage,product:ProductPage,cart:CartPage,checkout:CheckoutPage,account:AccountPage,orders:OrdersPage,search:SearchPage,contact:ContactPage,wishlist:WishlistPage,faq:FAQPage,legal:LegalPage},i=null,l=null;function L(){A(),I(),E(),h(),m(),b(),B(),q()}async function m(){try{if(!AuthApi.isAuthenticated()){let e=localStorage.getItem("wishlist");if(e){let o=JSON.parse(e);WishlistApi.updateBadge(o);let c=o.items||o.data&&o.data.items||[];u(c)}else u([]);return}let a=(await WishlistApi.getWishlist({pageSize:200})).data||{},t=a.items||a.data||[];WishlistApi.updateBadge(a),u(t)}catch{try{let a=localStorage.getItem("wishlist");if(a){let t=JSON.parse(a);WishlistApi.updateBadge(t);let e=t.items||t.data&&t.data.items||[];u(e)}}catch{}}}let y=[];function u(s){try{y=s||[];let a={},t={};(s||[]).forEach(e=>{let o=e.product||e.product_id||e.product&&e.product.id||null,c=e.product_slug||e.product&&e.product.slug||null,d=e.id||e.pk||e.uuid||e.item||null;o&&(a[String(o)]=d||!0),c&&(t[String(c)]=d||!0)}),document.querySelectorAll(".wishlist-btn").forEach(e=>{try{let o=e.querySelector("svg"),c=o?.querySelector(".heart-fill"),d=e.dataset.productId||e.closest("[data-product-id]")?.dataset.productId,r=e.dataset.productSlug||e.closest("[data-product-slug]")?.dataset.productSlug,n=null;d&&a.hasOwnProperty(String(d))?n=a[String(d)]:r&&t.hasOwnProperty(String(r))&&(n=t[String(r)]),n?(e.dataset.wishlistItemId=n,e.classList.add("text-red-500"),e.setAttribute("aria-pressed","true"),o?.classList.add("fill-current"),c&&(c.style.opacity="1")):(e.removeAttribute("data-wishlist-item-id"),e.classList.remove("text-red-500"),e.setAttribute("aria-pressed","false"),o?.classList.remove("fill-current"),c&&(c.style.opacity="0"))}catch{}})}catch{}}(function(){if(typeof MutationObserver>"u")return;let s=null;new MutationObserver(function(t){let e=!1;for(let o of t){if(o.addedNodes&&o.addedNodes.length){for(let c of o.addedNodes)if(c.nodeType===1&&(c.matches?.(".product-card")||c.querySelector?.(".product-card")||c.querySelector?.(".wishlist-btn"))){e=!0;break}}if(e)break}e&&(clearTimeout(s),s=setTimeout(()=>{try{u(y)}catch{}},150))}).observe(document.body,{childList:!0,subtree:!0})})();function A(){let s=window.location.pathname,a=document.body;if(a.dataset.page){i=a.dataset.page;return}if((s.startsWith("/accounts/")||s.startsWith("/account/"))&&!(s.startsWith("/accounts/profile")||s.startsWith("/account/profile"))){i=null;return}s==="/"||s==="/home/"?i="home":s==="/categories/"||s==="/products/"?i="search":s.startsWith("/categories/")&&s!=="/categories/"?i="category":s.startsWith("/products/")&&s!=="/products/"?i="product":s==="/search/"||s.startsWith("/search")?i="search":s.startsWith("/cart")?i="cart":s.startsWith("/checkout")?i="checkout":s==="/account"||s.startsWith("/account/")||s.startsWith("/accounts/profile")?i="account":s.startsWith("/orders")?i="orders":s.startsWith("/wishlist")?i="wishlist":s.startsWith("/contact")?i="contact":s.startsWith("/faq")?i="faq":(s.includes("privacy")||s.includes("terms")||s.includes("legal")||s.includes("policy"))&&(i="legal")}function I(){typeof Tabs<"u"&&document.querySelector("[data-tabs]")&&Tabs.init(),typeof Dropdown<"u"&&document.querySelectorAll("[data-dropdown-trigger]").forEach(s=>{let a=s.dataset.dropdownTarget,t=document.getElementById(a);t&&Dropdown.create(s,{content:t.innerHTML})})}function E(){i&&f[i]&&(l=f[i],typeof l.init=="function"&&l.init())}async function h(){if(document.querySelectorAll("[data-cart-count]").length)try{let t=(await CartApi.getCart()).data?.item_count||0;try{localStorage.setItem("cart",JSON.stringify({item_count:t,savedAt:Date.now()}))}catch{}g(t)}catch{try{let t=localStorage.getItem("cart");if(t){let o=JSON.parse(t)?.item_count||0;g(o);return}}catch(t){console.error("Failed to get cart count fallback:",t)}}}async function w(s){try{return(((await WishlistApi.getWishlist({pageSize:200})).data||{}).items||[]).find(c=>String(c.product)===String(s))?.id||null}catch{return null}}function g(s){document.querySelectorAll("[data-cart-count]").forEach(t=>{t.textContent=s>99?"99+":s,t.classList.toggle("hidden",s===0)})}function b(){document.addEventListener("cart:updated",async()=>{await h()}),document.addEventListener("wishlist:updated",async()=>{await m()}),document.addEventListener("auth:login",()=>{v(!0)}),document.addEventListener("auth:logout",()=>{v(!1)}),document.querySelectorAll(".wishlist-btn").forEach(a=>{try{let t=a.querySelector("svg"),e=t?.querySelector(".heart-fill");a.classList.contains("text-red-500")?(t?.classList.add("fill-current"),e&&(e.style.opacity="1")):e&&(e.style.opacity="0")}catch{}}),document.addEventListener("click",async a=>{let t=a.target.closest("[data-quick-add], [data-add-to-cart], .add-to-cart-btn");if(t){a.preventDefault();let e=t.dataset.productId||t.dataset.quickAdd||t.dataset.addToCart;if(!e)return;t.disabled=!0;let o=t.innerHTML;t.innerHTML='<svg class="animate-spin h-4 w-4 mx-auto" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>';try{await CartApi.addItem(e,1),Toast.success("Added to cart!"),document.dispatchEvent(new CustomEvent("cart:updated"))}catch(c){Toast.error(c.message||"Failed to add to cart.")}finally{t.disabled=!1,t.innerHTML=o}}}),document.addEventListener("click",async a=>{let t=a.target.closest("[data-wishlist-toggle], .wishlist-btn");if(t){if(a.preventDefault(),!AuthApi.isAuthenticated()){Toast.warning("Please login to add items to your wishlist."),window.location.href="/account/login/?next="+encodeURIComponent(window.location.pathname);return}let e=t.dataset.wishlistToggle||t.dataset.productId||t.closest("[data-product-id]")?.dataset.productId;t.disabled=!0;let o=t.dataset.wishlistItemId||"";!o&&t.classList.contains("text-red-500")&&(o=await w(e)||"");let d=t.classList.contains("text-red-500")&&o;try{if(d){let r=await WishlistApi.removeItem(o);t.classList.remove("text-red-500"),t.setAttribute("aria-pressed","false"),t.querySelector("svg")?.classList.remove("fill-current");let n=t.querySelector("svg")?.querySelector(".heart-fill");n&&(n.style.opacity="0"),t.removeAttribute("data-wishlist-item-id"),Toast.success("Removed from wishlist.")}else{let r=await WishlistApi.addItem(e),n=r.data?.id||r.data?.item?.id||await w(e);n&&(t.dataset.wishlistItemId=n),t.classList.add("text-red-500"),t.setAttribute("aria-pressed","true"),t.querySelector("svg")?.classList.add("fill-current");let S=t.querySelector("svg")?.querySelector(".heart-fill");S&&(S.style.opacity="1"),Toast.success(r.message||"Added to wishlist!")}}catch(r){console.error("wishlist:error",r),Toast.error(r.message||"Failed to update wishlist.")}finally{t.disabled=!1}}}),document.addEventListener("click",a=>{let t=a.target.closest("[data-quick-view], .quick-view-btn");if(t){a.preventDefault();let e=t.dataset.quickView||t.dataset.productId,o=t.dataset.productSlug;o?window.location.href=`/products/${o}/`:e&&(typeof Modal<"u"&&Modal.showQuickView?Modal.showQuickView(e):window.location.href=`/products/${e}/`)}}),document.addEventListener("click",async a=>{if(a.target.closest("[data-logout]")){a.preventDefault();try{await AuthApi.logout(),Toast.success("Logged out successfully."),document.dispatchEvent(new CustomEvent("auth:logout")),window.location.href="/"}catch{Toast.error("Failed to logout.")}}});let s=document.getElementById("back-to-top");s&&(window.addEventListener("scroll",Debounce.throttle(()=>{window.scrollY>500?s.classList.remove("opacity-0","pointer-events-none"):s.classList.add("opacity-0","pointer-events-none")},100)),s.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}))}function v(s){document.querySelectorAll("[data-auth-state]").forEach(t=>{let e=t.dataset.authState;e==="logged-in"?t.classList.toggle("hidden",!s):e==="logged-out"&&t.classList.toggle("hidden",s)})}function B(){let s=document.getElementById("mobile-menu-btn"),a=document.getElementById("close-mobile-menu"),t=document.getElementById("mobile-menu"),e=document.getElementById("mobile-menu-overlay");function o(){t?.classList.remove("translate-x-full"),e?.classList.remove("hidden"),document.body.classList.add("overflow-hidden")}function c(){t?.classList.add("translate-x-full"),e?.classList.add("hidden"),document.body.classList.remove("overflow-hidden")}s?.addEventListener("click",o),a?.addEventListener("click",c),e?.addEventListener("click",c)}function q(){let s=document.querySelector("[data-language-selector]"),a=document.getElementById("language-dropdown");s&&a&&(Dropdown.create(s,a),a.querySelectorAll("[data-language]").forEach(t=>{t.addEventListener("click",async()=>{let e=t.dataset.language;try{await LocalizationApi.setLanguage(e),Storage.set("language",e),window.location.reload()}catch{Toast.error("Failed to change language.")}})}))}function k(){l&&typeof l.destroy=="function"&&l.destroy(),i=null,l=null}return{init:L,destroy:k,getCurrentPage:()=>i,updateCartBadge:g}})();document.readyState==="loading"?document.addEventListener("DOMContentLoaded",p.init):p.init();window.App=p});C();})();
//# sourceMappingURL=app.bundle.js.map
